# Чеклист для проверки перед отправкой задания

## Общие требования

- [ ] Все файлы сохранены в папке `Task2/`
- [ ] Архитектурная документация создана и описана
- [ ] Все компоненты системы реализованы и работают

## Задача 1: Архитектура решения

- [ ] Создана архитектурная документация (`ARCHITECTURE.md`)
- [ ] Описан ETL-процесс с использованием Apache Airflow
- [ ] Описана витрина данных в OLAP БД (ClickHouse)
- [ ] Описан API сервис для получения отчётов
- [ ] Описаны потоки данных между компонентами
- [ ] Описаны меры безопасности

## Задача 2: Airflow DAG

- [ ] Создан DAG файл `prosthesis_reports_etl.py`
- [ ] Реализован процесс извлечения данных из CRM
- [ ] Реализован процесс извлечения данных телеметрии
- [ ] Реализована трансформация и агрегация данных
- [ ] Реализована загрузка в ClickHouse
- [ ] Настроено расписание запуска DAG (ежедневно в 02:00 UTC)
- [ ] Создана таблица витрины в ClickHouse
- [ ] Витрина оптимизирована для быстрого доступа (партиционирование, сортировка)

## Задача 3: Бэкенд API

- [ ] Создан сервис `bionicpro-reports` на Java
- [ ] Реализован эндпоинт `GET /api/reports`
- [ ] API возвращает отчёт из OLAP базы (ClickHouse)
- [ ] API не выполняет сложные вычисления в реальном времени
- [ ] API обрабатывает query параметры `startDate` и `endDate`
- [ ] API возвращает данные в формате JSON

## Задача 4: Ограничение доступа

- [ ] Реализована проверка аутентификации через JWT токен
- [ ] API проверяет, что пользователь авторизован
- [ ] API извлекает `user_id` из JWT токена
- [ ] API проверяет, что запрашиваются только данные текущего пользователя
- [ ] При попытке доступа к чужим данным возвращается ошибка 403
- [ ] При отсутствии авторизации возвращается ошибка 401

## Задача 5: UI компонент

- [ ] UI-код позволяет вызвать API для генерации отчётов
- [ ] Кнопка "Download Report" работает корректно
- [ ] Реализация не позволяет генерировать отчёт неавторизованному пользователю
- [ ] Реализация позволяет авторизованному пользователю получить только свой отчёт
- [ ] Обрабатываются ошибки от API (404, 403, 500)
- [ ] Отображается статус загрузки

## Дополнительные проверки

- [ ] API проверяет, что данные за запрошенный период уже обработаны Airflow
- [ ] При запросе данных, которых ещё нет в OLAP, возвращается понятное сообщение об ошибке
- [ ] Все сервисы добавлены в `docker-compose.yaml`
- [ ] Настроены подключения к базам данных (CRM, Telemetry, ClickHouse)
- [ ] Созданы SQL скрипты для инициализации баз данных
- [ ] Airflow настроен с правильными подключениями к базам данных

## Технические проверки

- [ ] Код компилируется без ошибок
- [ ] Нет критических ошибок линтера
- [ ] Все зависимости указаны в `pom.xml`
- [ ] Dockerfile для сервиса отчётов создан и корректен
- [ ] Конфигурационные файлы (`application.yml`) настроены правильно

## Функциональные проверки

- [ ] Можно запустить все сервисы через `docker-compose up`
- [ ] Airflow доступен по адресу `http://localhost:8082`
- [ ] DAG виден в интерфейсе Airflow
- [ ] DAG может быть запущен вручную
- [ ] API сервис доступен по адресу `http://localhost:8000`
- [ ] Эндпоинт `/api/reports/health` возвращает статус
- [ ] Frontend доступен по адресу `http://localhost:3000`
- [ ] Можно авторизоваться через Keycloak
- [ ] Можно получить отчёт через UI

## Безопасность

- [ ] JWT токены валидируются корректно
- [ ] Пользователь не может получить отчёт другого пользователя
- [ ] Все запросы к API требуют авторизации (кроме health check)
- [ ] Ошибки не раскрывают внутреннюю структуру системы

## Документация

- [ ] Создан файл `ARCHITECTURE.md` с описанием решения
- [ ] Создан файл `CHECKLIST.md` (этот файл)
- [ ] Код содержит комментарии где необходимо
- [ ] SQL скрипты содержат комментарии

